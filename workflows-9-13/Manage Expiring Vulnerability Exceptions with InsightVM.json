{"data":{"graph":{"edges":[{"edgeId":"1860bffb-1f92-4989-aa29-5699bf9cbd9a","fromNodeId":"ab6b2ea4-a963-48c4-8a58-51f9141e0d24","toNodeId":"4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a"},{"edgeId":"595c473c-74af-4c92-83ef-57c43cd0063b","fromNodeId":"7595f444-5c98-457b-ba52-b38863ae878a","name":"5 or less","toNodeId":"6f37cc6a-ddca-4931-ab23-96015984341a"},{"edgeId":"698325b6-c9b2-4915-8db5-60ded96bc5e3","fromNodeId":"9c37b91a-d658-4269-a92c-596ae0f92006"},{"edgeId":"77a880aa-1555-41d2-bd54-9ec4b74afa25","fromNodeId":"4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a","toNodeId":"715f6f94-06c6-4ae0-8861-b50e0c332166"},{"edgeId":"77b976c4-a810-4c19-96ba-ca88bb2c9a45","fromNodeId":"6f37cc6a-ddca-4931-ab23-96015984341a"},{"edgeId":"8e091eab-dee2-49ec-80c4-29363562c370","fromNodeId":"30b50fee-2433-49b6-a14c-1620134336bc"},{"edgeId":"b082b439-e203-478a-80ab-9b33aa770d4e","fromNodeId":"715f6f94-06c6-4ae0-8861-b50e0c332166","toNodeId":"7595f444-5c98-457b-ba52-b38863ae878a"},{"edgeId":"bf76fc19-108c-4dd7-80db-3c1f62e89ae0","fromNodeId":"7595f444-5c98-457b-ba52-b38863ae878a","name":"Zero","toNodeId":"9c37b91a-d658-4269-a92c-596ae0f92006"},{"edgeId":"d635d795-9f9c-47d0-ac1b-d6145f5e344f","fromNodeId":"7595f444-5c98-457b-ba52-b38863ae878a","name":"More than 5","toNodeId":"30b50fee-2433-49b6-a14c-1620134336bc"}],"nodes":[{"nodeId":"30b50fee-2433-49b6-a14c-1620134336bc"},{"nodeId":"4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a"},{"nodeId":"6f37cc6a-ddca-4931-ab23-96015984341a"},{"nodeId":"715f6f94-06c6-4ae0-8861-b50e0c332166"},{"nodeId":"7595f444-5c98-457b-ba52-b38863ae878a"},{"nodeId":"9c37b91a-d658-4269-a92c-596ae0f92006"},{"nodeId":"ab6b2ea4-a963-48c4-8a58-51f9141e0d24"}]},"name":"Manage Expiring Vulnerability Exceptions with InsightVM","notes":"# Description\n\nNotify a user weekly via Slack message of expiring exceptions.\n\n# Key Features\n\n* Quick management of exceptions with InsightVM through Slack\n\n# Requirements\n\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* InsightVM\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nAfter import, adjust the date and frequency in the `Weekly Timer` step as necessary.\n\nUpdate the `Channel` parameter to the channel in your environment where you would like reminders posted.\n\n## Usage\n\nThis workflow will trigger automatically with the frequency set in the `Weekly Timer` step.\n\n## Technical Details\n\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 InsightVM|4.9.0|1|\n|Timers|2.0.5|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.1.0 - Added workflow parameters, updated plugins\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Slack](https://slack.com/)\n","parameters":{"schema":{"definitions":{},"properties":{"Channel":{"description":"Channel used to post expiring vulnerabilities","type":"string"}},"required":[],"type":"object"},"values":{"Channel":"ka-testing-040822"}},"steps":[{"metadata":{"appName":"slack","chatOpsConnectionId":"ba6daa75-7cff-461b-a143-65525cf74bd0","continueOnFailure":false,"identifier":"post_message","isDisabled":false,"parameters":{"input":{"attachments":[],"message":"⚠  *Expiring Exceptions*  ⚠\n\nID: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[0].[id]}}\nName: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[0].[scope].[vulnerability]}}\nExpires: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[0].[expires]}}\n\nID: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[1].[id]}}\nName: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[1].[scope].[vulnerability]}}\nExpires: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[1].[expires]}}\n\nID: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[2].[id]}}\nName: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[2].[scope].[vulnerability]}}\nExpires: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[2].[expires]}}\n\nID: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[3].[id]}}\nName: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[3].[scope].[vulnerability]}}\nExpires: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[3].[expires]}}\n\nID: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[4].[id]}}\nName: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[4].[scope].[vulnerability]}}\nExpires: {{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions].[4].[expires]}}\n\n... More than 5 expiring exceptions found. The complete list can be found here: \n{{[$job].[URL]}}","recipient":"{{$workflow.[Channel]}}","thread_ts":""}}},"name":"More than 5 message","nodeId":"30b50fee-2433-49b6-a14c-1620134336bc","type":"action_chatops"},{"metadata":{"connectionId":"c87b69d8-8808-4de1-b835-db483451fd5c","continueOnFailure":false,"identifier":"get_expiring_vulnerability_exceptions","isCloud":false,"isDisabled":false,"parameters":{"input":{"expires_in_less_than":14}},"plugin":{"name":"rapid7_insightvm","vendor":"rapid7","version":"4.9.0"}},"name":"Get Expiring Exceptions","nodeId":"4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a","type":"action"},{"metadata":{"appName":"slack","chatOpsConnectionId":"ba6daa75-7cff-461b-a143-65525cf74bd0","continueOnFailure":false,"identifier":"post_message","isDisabled":false,"parameters":{"input":{"attachments":[],"message":"⚠  *Expiring Exceptions*  ⚠\n\n{{#each [4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}\nID: {{this.[id]}}\nName: {{this.[scope].[vulnerability]}}\nExpires: {{this.[expires]}}\n\n{{/each}}\n\n","recipient":"{{[$workflow].[Channel]}}","thread_ts":""}}},"name":"Less than 5 exceptions found","nodeId":"6f37cc6a-ddca-4931-ab23-96015984341a","type":"action_chatops"},{"metadata":{"isDisabled":false,"parameters":{"input":{"content":"{{#each [4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}\n{{this.[id]}},{{this.[expires]}},{{this.[scope].[vulnerability]}},{{this.[links].[0].[href]}}\n{{/each}}\n\n"},"type":"markdown"}},"name":"Create CSV","nodeId":"715f6f94-06c6-4ae0-8861-b50e0c332166","type":"artifact"},{"metadata":{"parameters":{"defaultEdgeId":"d635d795-9f9c-47d0-ac1b-d6145f5e344f","stepControlParams":[{"edgeId":"595c473c-74af-4c92-83ef-57c43cd0063b","expression":{"left":{"left":{"args":[{"name":"4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a.exceptions","type":"variable"}],"name":"length","type":"function"},"op":"\u003c","right":{"type":"literal","value":6},"type":"binary"},"op":"AND","right":{"left":{"args":[{"name":"4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a.exceptions","type":"variable"}],"name":"length","type":"function"},"op":"\u003e","right":{"type":"literal","value":0},"type":"binary"},"type":"binary"},"expressionText":"length({{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}) \u003c 6 AND length({{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}) \u003e 0"},{"edgeId":"bf76fc19-108c-4dd7-80db-3c1f62e89ae0","expression":{"left":{"args":[{"name":"4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a.exceptions","type":"variable"}],"name":"length","type":"function"},"op":"==","right":{"type":"literal","value":0},"type":"binary"},"expressionText":"length({{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}) == 0"},{"edgeId":"d635d795-9f9c-47d0-ac1b-d6145f5e344f","expression":{},"expressionText":""}]}},"name":"How many exceptions","nodeId":"7595f444-5c98-457b-ba52-b38863ae878a","type":"automated_decision"},{"metadata":{"appName":"slack","chatOpsConnectionId":"ba6daa75-7cff-461b-a143-65525cf74bd0","continueOnFailure":false,"identifier":"post_message","isDisabled":false,"parameters":{"input":{"attachments":[],"message":"✅  *No expiring exceptions found*  ✅","recipient":"{{$workflow.[Channel]}}","thread_ts":""}}},"name":"No expiring exceptions message","nodeId":"9c37b91a-d658-4269-a92c-596ae0f92006","type":"action_chatops"},{"metadata":{"identifier":"weekly","orchestratorId":"dc35eebf-8475-402b-94e0-58117e94ef01","parameters":{"input":{"day":"Friday","message":"","times_in_utc":"18:00:00"}},"plugin":{"name":"timers","vendor":"rapid7","version":"2.0.5"}},"name":"Weekly Timer","nodeId":"ab6b2ea4-a963-48c4-8a58-51f9141e0d24","type":"trigger_plugin"}],"summary":"","tags":["Rapid7","Slack","Vulnerability Management"],"timeSavingsDisplayUnit":"minutes","timeSavingsSeconds":1800}}