{"data":{"graph":{"edges":[{"edgeId":"006ba7ef-94c3-4ceb-aa56-6abdc74c8721","fromNodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb","name":"timeout"},{"edgeId":"12add100-c615-45e1-864f-a9d855e53b00","fromNodeId":"e2178aa8-6831-480f-9503-a8505720a9ae"},{"edgeId":"1a3f24c5-386c-4866-8cd6-a3123110b8f3","fromNodeId":"50c2a758-630b-412f-b638-73b94399bf73"},{"edgeId":"1d530971-e0c4-4ffa-82ab-9e5dd4bb0d15","fromNodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb","name":"Medium","toNodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7"},{"edgeId":"44028543-d321-4385-b5e3-280092b1fc01","fromNodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7","toNodeId":"7e971728-bf70-4917-8a7e-0821c424cbda"},{"edgeId":"47b233f3-a6f5-4aee-96ba-92904f4cc8fa","fromNodeId":"27d0bae4-c42f-4eee-9b2b-b3e7a5476bab","toNodeId":"d2a7b5b2-f0a0-4502-940d-174c847591ed"},{"edgeId":"4cc97390-a6ac-40ac-a4eb-91f2a8099631","fromNodeId":"cd8b89e4-0576-4ae0-aa37-1ae435721556"},{"edgeId":"80b85ff9-5bd4-4625-b1f6-daf24162b93b","fromNodeId":"04352684-ef7a-440f-9df3-be4c54f419af","toNodeId":"fdedd63c-13ff-4c52-8ba6-04573334639c"},{"edgeId":"93e4e6a9-9fdd-427c-8032-fba5e8d7601a","fromNodeId":"d2a7b5b2-f0a0-4502-940d-174c847591ed","name":"help","toNodeId":"50c2a758-630b-412f-b638-73b94399bf73"},{"edgeId":"9d77faa7-2531-4942-94c3-65c020ec1f69","fromNodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb","name":"Very High","toNodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7"},{"edgeId":"a5e29804-bc44-495a-8db5-97264624b76f","fromNodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb","name":"High","toNodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7"},{"edgeId":"a8a499e7-6a7e-4406-9cfa-5eb584f70803","fromNodeId":"7e971728-bf70-4917-8a7e-0821c424cbda","toNodeId":"e2178aa8-6831-480f-9503-a8505720a9ae"},{"edgeId":"b058bfd3-6813-4923-8bce-d785a25f1ea3","fromNodeId":"fdedd63c-13ff-4c52-8ba6-04573334639c","name":"Yes","toNodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb"},{"edgeId":"c4d30222-2cc9-4e46-993b-d904f2820965","fromNodeId":"fdedd63c-13ff-4c52-8ba6-04573334639c","name":"No","toNodeId":"cd8b89e4-0576-4ae0-aa37-1ae435721556"},{"edgeId":"d393e806-538a-43f3-a902-2ca70b5e711f","fromNodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb","name":"Very Low","toNodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7"},{"edgeId":"e369efcb-174f-40e4-8e82-e32af1395ac6","fromNodeId":"d2a7b5b2-f0a0-4502-940d-174c847591ed","name":"continue","toNodeId":"04352684-ef7a-440f-9df3-be4c54f419af"},{"edgeId":"e3d28c1b-e74c-4df0-81f0-42f793390834","fromNodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb","name":"Low","toNodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7"}],"nodes":[{"nodeId":"04352684-ef7a-440f-9df3-be4c54f419af"},{"nodeId":"27d0bae4-c42f-4eee-9b2b-b3e7a5476bab"},{"nodeId":"50c2a758-630b-412f-b638-73b94399bf73"},{"nodeId":"7e971728-bf70-4917-8a7e-0821c424cbda"},{"nodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb"},{"nodeId":"cd8b89e4-0576-4ae0-aa37-1ae435721556"},{"nodeId":"d2a7b5b2-f0a0-4502-940d-174c847591ed"},{"nodeId":"e2178aa8-6831-480f-9503-a8505720a9ae"},{"nodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7"},{"nodeId":"fdedd63c-13ff-4c52-8ba6-04573334639c"}]},"name":"Add Asset Criticality Tag with InsightVM from Slack","notes":"# Description\n\nSets criticality tag from Slack with an interactive Slack message.\n\nSample Slack Trigger Commands:\n\n`@Rapid7 InsightConnect crit-tag-asset \u003chostname\u003e`\n\n# Key Features\n\n* Set Asset Criticality Tag in Rapid7 InsightVM\n\n# Requirements\n\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* [Rapid7 InsightVM](https://www.rapid7.com/products/insightvm/)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nAfter the workflow has been import, activate the it in order to enable the ability to trigger it.\n\n### Usage\n\n*This workflow will trigger in any direct messages to your Chatbot **or** any message in a channel directed @ your Chatbot. Note the Chatbot must be in the channel in order to trigger the workflow this way.*\n\nTo trigger the workflow, send a direct message to your InsightConnect Slack Chatbot or @ your Chatbot in a public channel starting with the command `crit-tag-asset`.\n\nFor example:\n\n* `crit-tag-asset \u003chostname\u003e`\n\nThe workflow will post the results in a thread.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 InsightVM|4.8.1|2|\n|Type Converter|1.6.1|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* [Rapid7 InsightVM](https://www.rapid7.com/products/insightvm/)\n","steps":[{"metadata":{"connectionId":"c87b69d8-8808-4de1-b835-db483451fd5c","continueOnFailure":false,"identifier":"asset_search","isCloud":false,"isDisabled":false,"parameters":{"input":{"searchCriteria":{"filters":[{"field":"host-name","operator":"starts-with","value":"{{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[message].[words].[1]}}"}],"match":"all"},"size":0,"sort_criteria":{}}},"plugin":{"name":"rapid7_insightvm","vendor":"rapid7","version":"4.8.1"}},"name":"Search Asset by Hostname","nodeId":"04352684-ef7a-440f-9df3-be4c54f419af","type":"action"},{"metadata":{"appName":"slack","chatOpsConnectionId":"ba6daa75-7cff-461b-a143-65525cf74bd0","identifier":"message","parameters":{"input":{"matchChannel":".*","matchText":"crit-tag-asset","type":"any"}}},"name":"Trigger on Keyword crit-tag-asset","nodeId":"27d0bae4-c42f-4eee-9b2b-b3e7a5476bab","type":"trigger_chatops"},{"metadata":{"appName":"slack","chatOpsConnectionId":"ba6daa75-7cff-461b-a143-65525cf74bd0","continueOnFailure":false,"identifier":"post_message","isDisabled":false,"parameters":{"input":{"attachments":[],"message":"Usage: \n`crit-tag-asset \u003chostname\u003e`","recipient":"{{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[message].[channel_id]}}","thread_ts":"{{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[timestamp]}}"}}},"name":"Send Help Message","nodeId":"50c2a758-630b-412f-b638-73b94399bf73","type":"action_chatops"},{"metadata":{"continueOnFailure":false,"identifier":"string_to_integer","isCloud":true,"isDisabled":false,"parameters":{"input":{"input":"{{[04352684-ef7a-440f-9df3-be4c54f419af].[assets].[0].[id]}}","strip":true}},"plugin":{"name":"type_converter","vendor":"rapid7","version":"1.6.1"}},"name":"Convert Asset ID to Integer","nodeId":"7e971728-bf70-4917-8a7e-0821c424cbda","type":"action"},{"metadata":{"appName":"slack","chatOpsConnectionId":"ba6daa75-7cff-461b-a143-65525cf74bd0","identifier":"post_interactive_message","parameters":{"attachments":null,"message":"Found asset!\n\nID: {{[04352684-ef7a-440f-9df3-be4c54f419af].[assets].[0].[id]}}\nOS: {{[04352684-ef7a-440f-9df3-be4c54f419af].[assets].[0].[os]}}\n \n","messageType":"button","options":[{"answer":"Very High","buttonStyle":"default","confirmation":"OK! Assigning tag ... :hourglass_flowing_sand:","edgeId":"9d77faa7-2531-4942-94c3-65c020ec1f69","isTimeoutOnly":false},{"answer":"High","buttonStyle":"default","confirmation":"OK! Assigning tag ... :hourglass_flowing_sand:","edgeId":"a5e29804-bc44-495a-8db5-97264624b76f","isTimeoutOnly":false},{"answer":"Medium","buttonStyle":"default","confirmation":"OK! Assigning tag ... :hourglass_flowing_sand:","edgeId":"1d530971-e0c4-4ffa-82ab-9e5dd4bb0d15","isTimeoutOnly":false},{"answer":"Low","buttonStyle":"default","confirmation":"OK! Assigning tag ... :hourglass_flowing_sand:","edgeId":"e3d28c1b-e74c-4df0-81f0-42f793390834","isTimeoutOnly":false},{"answer":"Very Low","buttonStyle":"default","confirmation":"OK! Assigning tag ... :hourglass_flowing_sand:","edgeId":"d393e806-538a-43f3-a902-2ca70b5e711f","isTimeoutOnly":false},{"answer":"timeout","edgeId":"006ba7ef-94c3-4ceb-aa56-6abdc74c8721","isTimeoutOnly":true}],"question":"Which criticality tag do you want to assign?","recipient":"{{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[message].[channel_id]}}","threadTimestamp":"{{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[timestamp]}}","timeout":60,"timeoutDisplayUnit":"minutes","timeoutEdgeId":"006ba7ef-94c3-4ceb-aa56-6abdc74c8721"}},"name":"Ask for Criticality Tag","nodeId":"c04bf71a-bef9-4df2-b81c-70f624a996bb","type":"decision_chatops"},{"metadata":{"appName":"slack","chatOpsConnectionId":"ba6daa75-7cff-461b-a143-65525cf74bd0","continueOnFailure":false,"identifier":"post_message","isDisabled":false,"parameters":{"input":{"attachments":[],"message":"No or multiple assets found!\n\n{{#each [04352684-ef7a-440f-9df3-be4c54f419af].[assets]}}\n{{hostName}}\n{{/each}}","recipient":"{{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[message].[channel_id]}}","thread_ts":"{{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[timestamp]}}"}}},"name":"No or Multiple Assets Found","nodeId":"cd8b89e4-0576-4ae0-aa37-1ae435721556","type":"action_chatops"},{"metadata":{"parameters":{"defaultEdgeId":"93e4e6a9-9fdd-427c-8032-fba5e8d7601a","stepControlParams":[{"edgeId":"93e4e6a9-9fdd-427c-8032-fba5e8d7601a","expression":{},"expressionText":""},{"edgeId":"e369efcb-174f-40e4-8e82-e32af1395ac6","expression":{"left":{"args":[{"name":"27d0bae4-c42f-4eee-9b2b-b3e7a5476bab.message.words","type":"variable"}],"name":"length","type":"function"},"op":"=","right":{"type":"literal","value":2},"type":"binary"},"expressionText":"length({{[27d0bae4-c42f-4eee-9b2b-b3e7a5476bab].[message].[words]}}) = 2"}]}},"name":"Check Parameters","nodeId":"d2a7b5b2-f0a0-4502-940d-174c847591ed","type":"automated_decision"},{"metadata":{"connectionId":"c87b69d8-8808-4de1-b835-db483451fd5c","continueOnFailure":false,"identifier":"tag_asset","isCloud":false,"isDisabled":false,"parameters":{"input":{"asset_id":"{{[7e971728-bf70-4917-8a7e-0821c424cbda].[output]}}","tag_id":"{{[e37bb114-90d9-4b90-9395-373ba43fbca7].[tag]}}"}},"plugin":{"name":"rapid7_insightvm","vendor":"rapid7","version":"4.8.1"}},"name":"Assign Tag","nodeId":"e2178aa8-6831-480f-9503-a8505720a9ae","type":"action"},{"metadata":{"isDisabled":false,"parameters":{"decisionEdgeIds":["d393e806-538a-43f3-a902-2ca70b5e711f","9d77faa7-2531-4942-94c3-65c020ec1f69","e3d28c1b-e74c-4df0-81f0-42f793390834","a5e29804-bc44-495a-8db5-97264624b76f","1d530971-e0c4-4ffa-82ab-9e5dd4bb0d15"],"variableSets":[{"arrayType":null,"inputBuilderSchemas":null,"name":"tag","type":"integer","variables":{"1d530971-e0c4-4ffa-82ab-9e5dd4bb0d15":3,"9d77faa7-2531-4942-94c3-65c020ec1f69":1,"a5e29804-bc44-495a-8db5-97264624b76f":2,"d393e806-538a-43f3-a902-2ca70b5e711f":5,"e3d28c1b-e74c-4df0-81f0-42f793390834":4}},{"arrayType":null,"inputBuilderSchemas":null,"name":"Responding User","type":"string","variables":{"1d530971-e0c4-4ffa-82ab-9e5dd4bb0d15":"{{[c04bf71a-bef9-4df2-b81c-70f624a996bb].[responding_user]}}","9d77faa7-2531-4942-94c3-65c020ec1f69":"{{[c04bf71a-bef9-4df2-b81c-70f624a996bb].[responding_user]}}","a5e29804-bc44-495a-8db5-97264624b76f":"{{[c04bf71a-bef9-4df2-b81c-70f624a996bb].[responding_user]}}","d393e806-538a-43f3-a902-2ca70b5e711f":"{{[c04bf71a-bef9-4df2-b81c-70f624a996bb].[responding_user]}}","e3d28c1b-e74c-4df0-81f0-42f793390834":"{{[c04bf71a-bef9-4df2-b81c-70f624a996bb].[responding_user]}}"}}]}},"name":"Join","nodeId":"e37bb114-90d9-4b90-9395-373ba43fbca7","type":"join"},{"metadata":{"parameters":{"defaultEdgeId":"c4d30222-2cc9-4e46-993b-d904f2820965","stepControlParams":[{"edgeId":"b058bfd3-6813-4923-8bce-d785a25f1ea3","expression":{"left":{"args":[{"name":"04352684-ef7a-440f-9df3-be4c54f419af.assets","type":"variable"}],"name":"length","type":"function"},"op":"=","right":{"type":"literal","value":1},"type":"binary"},"expressionText":"length({{[04352684-ef7a-440f-9df3-be4c54f419af].[assets]}}) = 1"},{"edgeId":"c4d30222-2cc9-4e46-993b-d904f2820965","expression":{},"expressionText":""}]}},"name":"Asset found?","nodeId":"fdedd63c-13ff-4c52-8ba6-04573334639c","type":"automated_decision"}],"summary":"","tags":["Rapid7","Slack","Vulnerability Management"],"timeSavingsDisplayUnit":"minutes","timeSavingsSeconds":1800}}