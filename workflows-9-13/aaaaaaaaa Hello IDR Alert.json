{"data":{"graph":{"edges":[{"edgeId":"4a847901-43f2-4d7a-a8ca-495fe8cac3e4","fromNodeId":"1c857813-dc83-422e-84fc-46d619db4141","toNodeId":"a77ed7cc-0a20-40a0-8875-bea7433b64ee"},{"edgeId":"be03afbd-e006-48eb-9bd7-ee15f639d1ce","fromNodeId":"a77ed7cc-0a20-40a0-8875-bea7433b64ee"}],"nodes":[{"nodeId":"1c857813-dc83-422e-84fc-46d619db4141"},{"nodeId":"a77ed7cc-0a20-40a0-8875-bea7433b64ee"}]},"name":"aaaaaaaaa Hello IDR Alert","notes":"# Description\n\nThe Hello IDR Alert workflow is meant to introduce InsightIDR users to the InsightIDR User Behavior Analytics (UBA) Alert Trigger in InsightConnect and to help them run their first response workflow from an Investigation in InsightIDR.\n\nTo use this workflow, import and activate it in InsightConnect. Then, open an Investigation in InsightIDR and use the Take Action menu to find your Custom InsightConnect Workflow and run it!\n\n# Key Features\n\n* Learn how to run response workflows from an InsightIDR Investigation\n* Learn which trigger output variables are available for use in custom workflows\n* Experience using InsightConnect along with InsightIDR firsthand!\n\n# Requirements\n\n* InsightIDR License\n* InsightConnect License\n\n# Documentation\n\n## Setup\n\nSimply import and activate the workflow in InsightConnect! No additional setup is required for this workflow.\n\n### Usage\n\n1. Open an Investigation in InsightIDR\n2. Click the `Take Action` button in the Investigation to open the response panel\n3. Select `Custom InsightConnect Workflows` from the `Action Category` list\n4. Select the `Hello IDR Alert` workflow (Note: If you changed the name of the workflow during the import process, then you will see a different workflow name!)\n5. Select all Users, Assets, and/or Indicators (IPs, URLs, Domains, or Processes) available in the IDR Investigation\n6. Click `Take Action`!\n\nAn event will be automatically added to your Investigation Timeline in InsightIDR. Click on it to see the results of your workflow!\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.1 - Updated artifact\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n","steps":[{"metadata":{},"name":"IDR Alert Trigger","nodeId":"1c857813-dc83-422e-84fc-46d619db4141","type":"trigger_api_idr"},{"metadata":{"isDisabled":false,"parameters":{"input":{"content":"# The InsightIDR UBA Alert Trigger\n*Congratulations! You've successfully run a workflow using the InsightIDR User Behavior Analytics (UBA) Alert Trigger. This Artifact card will explain some of the variables you can use with this trigger.*\n\n## Standard Trigger Outputs\n* The IDR UBA Alert Trigger includes several outputs that will be present for any UBA alert\n* These trigger outputs may be used in Artifact cards like this and as inputs for subsequent workflow steps\n* The following variables will be present in every IDR UBA Alert:\n    * `name`: {{[1c857813-dc83-422e-84fc-46d619db4141].[name]}}\n    * `type`: {{[1c857813-dc83-422e-84fc-46d619db4141].[type]}}\n    * `timestamp`: {{[1c857813-dc83-422e-84fc-46d619db4141].[timestamp]}}\n    * `description`: {{[1c857813-dc83-422e-84fc-46d619db4141].[description]}}\n    * `link`: {{[1c857813-dc83-422e-84fc-46d619db4141].[link]}}\n    * `investigationId`: {{[1c857813-dc83-422e-84fc-46d619db4141].[investigationId]}}\n\n\n## Users\n* The `Users` array contains details of each User involved in the alert\n* Items from the `Users` array may be used in workflows that:\n    * Notify users of their involvement in a reported security incident via email, Slack, Teams, SMS, etc.\n    * Disable user accounts\n    * Reset user passwords\n* The `Users` array contains the following variables for each user  passed from the InsightIDR UBA Alert Trigger:\n    * `name`: {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[users].[0].[name]}}\n    * `distinguishedName`: {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[users].[0].[distinguishedName]}}\n    * `emails`: {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[users].[0].[emails]}}\n* In it's raw JSON format, the Users array looks like this:\n    * {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[users]}}\n\n*If there are no users in the Investigation, or no users are selected when running the workflow from the IDR investigation, then the Users array and all variables within it will be empty.*\n\n## Assets\n* The Assets array contains details of each asset involved in the alert\n* Items from the `Assets` array may be used in workflows that:\n    * Validate or correlate assets against a source of truth, such as Active Directory or a CMDB\n    * Quarantine assets using the Insight agent or third-party EDR solutions\n    * Stop vulnerable instances in cloud environments\n* The Assets array contains the following variables for each asset passed from the InsightIDR UBA Alert Trigger:\n    * `assetId` = {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[assets].[0].[assetId]}}\n    * `fqdn` = {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[assets].[0].[fqdn]}}\n    * `shortname` = {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[assets].[0].[shortname]}}\n* In it's raw JSON format, the Assets array looks like this:\n    * {{[1c857813-dc83-422e-84fc-46d619db4141].[actors].[assets]}}\n\n*If there are no assets in the Investigation, or no assets are selected when running the workflow from the IDR investigation, then the Assets array and all variables within it will be empty.*\n\n## Contents\n* The `Contents` array contains any indicators of compromise present in the alert\n* Items from the Contents array may be used in workflows that:\n    * Enrich indicators with third-party threat intelligence to validate a threat and collect additional intel on the threat actor\n    * Block malicious entities at the network or endpoint level\n    * Use sandboxes to visit and observe web destinations advertised in phishing campaigns\n\n* The `Contents` array contains the following variables:\n    * `urls`: {{[1c857813-dc83-422e-84fc-46d619db4141].[contents].[urls]}}\n    * `domains`: {{[1c857813-dc83-422e-84fc-46d619db4141].[contents].[domains]}}\n    * `processes`: {{[1c857813-dc83-422e-84fc-46d619db4141].[contents].[processes]}}\n    * `ipAddresses`: {{[1c857813-dc83-422e-84fc-46d619db4141].[contents].[ipAddresses]}}\n\n*If there are no indicators in the Investigation, or no indicators are selected when running the workflow from the IDR investigation, then the Contents array and all variables within it will be empty.*\n\n## Up Next\n1. View your **[Automation History](#/automation/history)** in InsightIDR\n2. View this **[Job]({{[$job].[URL]}})** in InsightConnect\n3. From the Job page, head on back to the **[Discover](#/home?loadDiscover=1)** tab in InsightConnect to try your next workflow!"},"type":"markdown"}},"name":"Alert Artifact","nodeId":"a77ed7cc-0a20-40a0-8875-bea7433b64ee","type":"artifact"}],"summary":"","tags":["Alerting \u0026 Notifications","Rapid7","Utility"],"timeSavingsDisplayUnit":"minutes","timeSavingsSeconds":60}}